[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Confounders",
    "section": "",
    "text": "Se desea hacer un modelo lineal simple entre las variables del dataset de seguros registrando la amplitud del efecto en la forma de los coeficientes que acompañana a la o las variables independientes. Para eso se probarán y compararán distintos modelos identificando el mejor de ellos.\n\nCode# Se importan las librerías necesarias\nlibrary(tidyverse)\nlibrary(modelr)\nlibrary(sjPlot)\nlibrary(sjmisc)\nlibrary(sjlabelled)\n\n# Directorio de trabajo y nombre de archivo\ndata_folder <- \"dataset\"\nfile_name <- \"Insurance.csv\"\n\n# Se importa el dataset y se eliminan filas repetidas\ndf_seguros <- read.csv(file.path(data_folder, file_name), dec=\",\", stringsAsFactors = TRUE)\ndf_seguros <- unique(df_seguros)\n\n# Se agrega la columna salud\ndf_seguros <- mutate(df_seguros,\n                     salud = case_when((bmi >= 30 & smoker == 'yes') ~ 'OF', \n                                       (bmi >= 30 & smoker == 'no') ~ 'ONF', \n                                       (bmi < 30 & smoker == 'yes') ~ 'NOF', \n                                       (bmi < 30 & smoker == 'no') ~ 'NONF'))\ndf_seguros$salud = factor(df_seguros$salud, levels = c(\"OF\", \"NOF\", \"ONF\", \"NONF\"), ordered = TRUE)\n\n# Cambia tamaño del plot\n# options(repr.plot.width=16, repr.plot.height=12)"
  },
  {
    "objectID": "index.html#limpieza-y-adecuación-de-los-datos",
    "href": "index.html#limpieza-y-adecuación-de-los-datos",
    "title": "Confounders",
    "section": "Limpieza y adecuación de los datos",
    "text": "Limpieza y adecuación de los datos\nEl dataset provisto posee 7 columnas, con variables categóricas (sexo, fumador, región) y numéricas (edad, índice de masa corporal, hijes, gastos de seguro médico). Se verificó que la importación de los datos sea correcta y se eliminaron filas repetidas. Se agregó 1 nueva columna llamada “salud”:\n\n\nSalud: considerando la obesidad de una persona como el BMI mayor o igual a 30 y si esta persona es fumadora, separa entre personas Obesas Fumadoras (OF), Obesas No Fumadoras (ONF), No Obesas Fumadoras (NOF) y No Obesas No Fumadoras (NONF)."
  },
  {
    "objectID": "index.html#modelo-lineal-simple-n-1",
    "href": "index.html#modelo-lineal-simple-n-1",
    "title": "Confounders",
    "section": "Modelo lineal simple N° 1",
    "text": "Modelo lineal simple N° 1\nSe realizaron dos variaciones de un modelo lineal simple (ver Figure 1) teniendo en cuenta los gastos de una persona en función de su edad. Se utilizaron las fórmulas:\n\nModelo 1.1: \\(y\\) ~ \\(x_1\\)\nModelo 1.2: \\(y\\) ~ \\(x_1 - 1\\)\n\nReemplazando: \\(y = charges,\\) \\(x_1 = age\\).\n\nCode# Modelo lineal simple\nseguros_mod1 <- lm(charges ~ age, data = df_seguros)\nseguros_mod1_2 <- lm(charges ~ age - 1, data = df_seguros)\n\n# Agrego predicciones\ngrid <- df_seguros %>%\n  data_grid(age, charges) %>%\n  gather_predictions(seguros_mod1, seguros_mod1_2)\n\n# Grafico \nggplot(df_seguros, aes(x=age)) +\n  geom_point(aes(y = charges), size = 1) +\n  geom_line(aes(y = pred), data = grid, colour = \"red\", size = 1) + \n  labs(\n    x = 'Edad (años)',\n    y = 'Gastos de Seguro (US$)',\n    title = 'Gastos de seguro vs Edad de la persona',\n    subtitle = 'Personas estadounidenses') +\n  theme(axis.line = element_line(colour = \"black\", size = 0.5)) + \n  facet_wrap(~model, labeller = labeller(model = c(\n    \"seguros_mod1\" = \"Modelo 1.1: charges ~ age\",\n    \"seguros_mod1_2\" = \"Modelo 1.2: charges ~ age - 1\")))\n\n\n\nFigure 1: Modelo lineal simple N° 1 - Gastos vs Edad.\n\n\n\n\nSe observó que el Modelo 1.2 tiene mejor estimación que el Modelo 1.1 ya que las edades no comienzan en 0; y al suprimir la ordenada al origen del modelo, se obtiene una mejor tendencia. Sin embargo, ninguno de ambos modelos se ajusta debidamente a los datos ya que hay otros factores que influyen en los gastos de una persona como su estado de salud. Las estadísticas de los Modelos 1.1 (ver Table 1) y 1.2 (ver Table 2) demuestran que efectivamente no son ideales.\n\nCode# Estadísticas del modelo\ntab_model(seguros_mod1,\n          show.se = TRUE,\n          show.std = TRUE,\n          show.stat = TRUE,\n          col.order = c(\"p\", \"stat\", \"est\", \"std.se\", \"se\", \"std.est\"), \n          p.style = \"scientific\", digits.p = 2)\n\n\n\n\nTable 1:  Estadísticas del modelo lineal simple N° 1.1. \n\n \ncharges\n\n\nPredictors\np\nStatistic\nEstimates\nstandardized std. Error\nstd. Error\nstd. Beta\n\n\n(Intercept)\n6.95e-04\n3.40\n3190.02\n0.03\n938.40\n0.00\n\n\nage\n6.98e-29\n11.42\n257.23\n0.03\n22.53\n0.30\n\n\nObservations\n1337\n\n\nR2 / R2 adjusted\n0.089 / 0.088\n\n\n\n\n\n\nCode# Estadísticas del modelo\ntab_model(seguros_mod1_2,\n          show.se = TRUE,\n          show.std = TRUE,\n          show.stat = TRUE,\n          col.order = c(\"p\", \"stat\", \"est\", \"std.se\", \"se\", \"std.est\"), \n          p.style = \"scientific\", digits.p = 2)\n\n\n\n\nTable 2:  Estadísticas del modelo lineal simple N° 1.2. \n\n \ncharges\n\n\nPredictors\np\nStatistic\nEstimates\nstandardized std. Error\nstd. Error\nstd. Beta\n\n\nage\n5.68e-256\n43.21\n329.33\n0.03\n7.62\n0.30\n\n\nObservations\n1337\n\n\nR2 / R2 adjusted\n0.583 / 0.583"
  },
  {
    "objectID": "index.html#modelo-lineal-simple-n-2",
    "href": "index.html#modelo-lineal-simple-n-2",
    "title": "Confounders",
    "section": "Modelo lineal simple N° 2",
    "text": "Modelo lineal simple N° 2\nPara mejorar la estimación de los gastos, se procede a cambiar el modeloagregando la variable “salud” que posee 4 posibles estados de salud (ver Figure 2). Se utilizan los modelos:\n\nModelos 2.1: \\(y\\) ~ \\(x_1 + x_2\\)\nModelos 2.2: \\(y\\) ~ \\(x_1 + x_2 - 1\\)\n\nReemplazando: \\(y = charges,\\) \\(x_1 = age,\\) \\(x_2 = salud\\).\n\nCode# Modelo lineal simple 2\nseguros_mod2 <- lm(charges ~ age + salud, data = df_seguros)\nseguros_mod2_2 <- lm(charges ~ age + salud - 1, data = df_seguros)\n\n# Agrego predicciones\ngrid2 <- df_seguros %>%\n  data_grid(age, charges, salud) %>%\n  gather_predictions(seguros_mod2, seguros_mod2_2)\n\n# Grafico \nggplot(df_seguros, aes(x=age, y = charges, color=salud)) +\n  geom_point(size = 1) +\n  geom_line(aes(y = pred), data = grid2, size = 1) + \n  labs(\n    x = 'Edad (años)',\n    y = 'Gastos de Seguro (US$)',\n    title = 'Gastos de seguro vs Edad de la persona y su estado de salud',\n    subtitle = 'Personas estadounidenses con distintos estados de salud',\n    color = 'Estado de salud') +\n  scale_color_discrete(labels = c('Obeso Fumador (OF)','No Obeso Fumador (NOF)','Obeso No Fumador (ONF)','No Obeso No Fumador (NONF)')) + \n  theme(legend.position=\"bottom\", axis.line = element_line(colour = \"black\", size = 0.5))+\n  guides(color=guide_legend(nrow=2,byrow=TRUE))+\n  facet_wrap(~model, labeller = labeller(model = c(\n    \"seguros_mod2\" = \"Modelo 2.1: charges ~ age + salud\",\n    \"seguros_mod2_2\" = \"Modelo 2.2: charges ~ age + salud - 1\")))\n\n\n\nFigure 2: Modelo lineal simple N° 2 - Gastos vs Edad y Salud.\n\n\n\n\nSe observa que los nuevos modelos tienen mejores estimaciones para los distintos grupos de personas según su estado de salud, siendo mucho mejor el Modelo 2.2 según la comparación de las estadísticas de los modelos (Modelo 2.1, ver Table 3 y Modelo 2.2, ver Table 4).\n\nCode# Estadísticas del modelo\ntab_model(seguros_mod2, \n          show.se = TRUE,\n          show.std = TRUE,\n          show.stat = TRUE,\n          col.order = c(\"p\", \"stat\", \"est\", \"std.se\", \"se\", \"std.est\"), \n          p.style = \"scientific\", digits.p = 2)\n\n\n\n\nTable 3:  Estadísticas del modelo lineal simple N° 2.1. \n\n \ncharges\n\n\nPredictors\np\nStatistic\nEstimates\nstandardized std. Error\nstd. Error\nstd. Beta\n\n\n(Intercept)\n9.73e-114\n25.04\n9523.57\n0.01\n380.29\n0.56\n\n\nage\n2.19e-151\n29.99\n267.72\n0.01\n8.93\n0.31\n\n\nsalud [linear]\n0.00e+00\n-82.82\n-25286.22\n0.03\n305.33\n-2.09\n\n\nsalud [quadratic]\n1.34e-165\n31.80\n9851.18\n0.03\n309.77\n0.81\n\n\nsalud [cubic]\n3.48e-06\n4.66\n1466.13\n0.03\n314.62\n0.12\n\n\nObservations\n1337\n\n\nR2 / R2 adjusted\n0.858 / 0.858\n\n\n\n\n\n\nCode# Estadísticas del modelo\ntab_model(seguros_mod2_2, \n          show.se = TRUE,\n          show.std = TRUE,\n          show.stat = TRUE,\n          col.order = c(\"p\", \"stat\", \"est\", \"std.se\", \"se\", \"std.est\"), \n          p.style = \"scientific\", digits.p = 2)\n\n\n\n\nTable 4:  Estadísticas del modelo lineal simple N° 2.2. \n\n \ncharges\n\n\nPredictors\np\nStatistic\nEstimates\nstandardized std. Error\nstd. Error\nstd. Beta\n\n\nage\n2.19e-151\n29.99\n267.72\n0.01\n8.93\n0.31\n\n\nsaludOF\n0.00e+00\n60.31\n31083.83\n0.03\n515.40\n2.34\n\n\nsaludNOF\n1.32e-87\n21.41\n11235.67\n0.03\n524.89\n0.70\n\n\nsaludONF\n7.98e-07\n-4.96\n-2039.70\n0.02\n411.27\n-0.40\n\n\nsaludNONF\n3.91e-08\n-5.53\n-2185.51\n0.02\n395.41\n-0.41\n\n\nObservations\n1337\n\n\nR2 / R2 adjusted\n0.936 / 0.936"
  },
  {
    "objectID": "index.html#modelo-lineal-simple-n-3",
    "href": "index.html#modelo-lineal-simple-n-3",
    "title": "Confounders",
    "section": "Modelo lineal simple N° 3",
    "text": "Modelo lineal simple N° 3\nSe analizó una última serie de modelos (ver Figure 3) para comprobar si pueden mejorar la estimación del Modelo 2.2 (ver Table 4). Se utilizaron las siguientes fórmulas:\n\nModelos 3.1: \\(y\\) ~ \\(x_1 * x_2\\)\nModelos 3.2: \\(y\\) ~ \\(x_1 * x_2 - 1\\)\n\nReemplazando: \\(y = charges,\\) \\(x_1 = age,\\) \\(x_2 = salud\\).\n\nCode# Modelo lineal simple 2\nseguros_mod3 <- lm(charges ~ age * salud, data = df_seguros)\nseguros_mod3_2 <- lm(charges ~ age * salud - 1, data = df_seguros)\n\n# Agrego predicciones\ngrid3 <- df_seguros %>%\n  data_grid(age, charges, salud) %>%\n  gather_predictions(seguros_mod3, seguros_mod3_2)\n\n# Grafico \nggplot(df_seguros, aes(x=age, y = charges, color=salud)) +\n  geom_point(size = 1) +\n  geom_line(aes(y = pred), data = grid3, size = 1) + \n  labs(\n    x = 'Edad (años)',\n    y = 'Gastos de Seguro (US$)',\n    title = 'Gastos de seguro vs Edad de la persona y su estado de salud',\n    subtitle = 'Personas estadounidenses con distintos estados de salud',\n    color = 'Estado de salud') +\n  scale_color_discrete(labels = c('Obeso Fumador (OF)','No Obeso Fumador (NOF)','Obeso No Fumador (ONF)','No Obeso No Fumador (NONF)')) + \n  theme(legend.position=\"bottom\", axis.line = element_line(colour = \"black\", size = 0.5))+\n  guides(color=guide_legend(nrow=2,byrow=TRUE))+\n  facet_wrap(~model, labeller = labeller(model = c(\n    \"seguros_mod3\" = \"Modelo 3.1: charges ~ age * salud\",\n    \"seguros_mod3_2\" = \"Modelo 3.2: charges ~ age * salud - 1\")))\n\n\n\nFigure 3: Modelo lineal simple N° 3 - Gastos vs Edad y Salud.\n\n\n\n\nAl no poder visualizar un cambio significativo con respecto al gráfico del Modelo 2.2 (ver Figure 2), se procede a observar las estadísticas (Modelo 3.1 ver Table 5, y Modelo 3.2 ver Table 6.\n\nCode# Estadísticas del modelo\ntab_model(seguros_mod3, \n          show.se = TRUE,\n          show.std = TRUE,\n          show.stat = TRUE,\n          col.order = c(\"p\", \"stat\", \"est\", \"std.se\", \"se\", \"std.est\"), \n          p.style = \"scientific\", digits.p = 2)\n\n\n\n\nTable 5:  Estadísticas del modelo lineal simple N° 3.1. \n\n \ncharges\n\n\nPredictors\np\nStatistic\nEstimates\nstandardized std. Error\nstd. Error\nstd. Beta\n\n\n(Intercept)\n2.00e-82\n20.66\n9481.83\n0.01\n459.05\n0.56\n\n\nage\n6.34e-106\n23.98\n268.72\n0.01\n11.20\n0.31\n\n\nsalud [linear]\n2.59e-134\n-27.78\n-24943.04\n0.03\n897.83\n-2.09\n\n\nsalud [quadratic]\n4.45e-24\n10.32\n9476.10\n0.03\n918.11\n0.81\n\n\nsalud [cubic]\n6.05e-02\n1.88\n1762.24\n0.03\n937.94\n0.12\n\n\nage * salud [linear]\n6.88e-01\n-0.40\n-8.75\n0.03\n21.77\n-0.01\n\n\nage * salud [quadratic]\n6.66e-01\n0.43\n9.67\n0.03\n22.41\n0.01\n\n\nage * salud [cubic]\n7.36e-01\n-0.34\n-7.75\n0.03\n23.03\n-0.01\n\n\nObservations\n1337\n\n\nR2 / R2 adjusted\n0.858 / 0.858\n\n\n\n\n\n\nCode# Estadísticas del modelo\ntab_model(seguros_mod3_2, \n          show.se = TRUE,\n          show.std = TRUE,\n          show.stat = TRUE,\n          col.order = c(\"p\", \"stat\", \"est\", \"std.se\", \"se\", \"std.est\"), \n          p.style = \"scientific\", digits.p = 2)\n\n\n\n\nTable 6:  Estadísticas del modelo lineal simple N° 3.2. \n\n \ncharges\n\n\nPredictors\np\nStatistic\nEstimates\nstandardized std. Error\nstd. Error\nstd. Beta\n\n\nage\n6.34e-106\n23.98\n268.72\n0.01\n11.20\n0.31\n\n\nsaludOF\n7.27e-133\n27.59\n30558.13\n0.03\n1107.51\n2.34\n\n\nsaludNOF\n4.73e-21\n9.58\n11503.36\n0.03\n1201.26\n0.70\n\n\nsaludONF\n5.11e-04\n-3.48\n-2015.80\n0.02\n578.67\n-0.40\n\n\nsaludNONF\n4.88e-04\n-3.50\n-2118.37\n0.02\n605.99\n-0.41\n\n\nage * salud L\n6.88e-01\n-0.40\n-8.75\n0.03\n21.77\n-0.01\n\n\nage * salud Q\n6.66e-01\n0.43\n9.67\n0.03\n22.41\n0.01\n\n\nage * salud C\n7.36e-01\n-0.34\n-7.75\n0.03\n23.03\n-0.01\n\n\nObservations\n1337\n\n\nR2 / R2 adjusted\n0.936 / 0.935\n\n\n\n\n\nPuede verse que el Modelo 3.2 (ver Table 6) tiene muy buenas estimaciones con respecto al Modelo 3.1 (ver Table 5). A su vez, si comparamos los Modelos 2.2 (ver Table 4) y 3.2, se observa que son prácticamente idénticos siendo ligeramente mejor el Modelo 2.2."
  },
  {
    "objectID": "index.html#conclusiones",
    "href": "index.html#conclusiones",
    "title": "Confounders",
    "section": "Conclusiones",
    "text": "Conclusiones\nSe decide optar por usar el Modelo 2.2 (ver Figure 2 y Table 4) ya que tiene una mejor estimación para los gastos de las personas según su edad y estado de salud."
  }
]